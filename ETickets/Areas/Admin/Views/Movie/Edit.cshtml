@model Movie
@using ETickets.Models
@{
    ViewBag.Categories = ViewBag.Categories ?? new List<Category>();
    ViewBag.Actors = ViewBag.Actors ?? new List<Actor>();
    ViewBag.Cinemas = ViewBag.Cinemas ?? new List<Cinema>();
}

<div class="container col-12">
    <div class="row">
        <div class="col-12">
            <h2 class="display-6">Edit Movie</h2>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <form method="post">
                <input type="hidden" asp-for="Id" />

                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="Movie Name" asp-for="Name">
                </div>

                <div class="mb-3">
                    <textarea class="form-control" placeholder="Description" asp-for="Description" rows="3"></textarea>
                </div>

                <div class="mb-3">
                    <input type="number" step="0.01" class="form-control" placeholder="Price" asp-for="Price">
                </div>

                <div class="mb-3">
                    <input type="date" class="form-control" asp-for="StartDate">
                </div>

                <div class="mb-3">
                    <input type="date" class="form-control" asp-for="EndDate">
                </div>

                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="Trailer URL" asp-for="TrailerUrl">
                </div>

                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="Status" asp-for="MovieStatus">
                </div>

                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="Rating" asp-for="MovieRate">
                </div>

                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="PG Rating" asp-for="PgRate">
                </div>

                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="Tags" asp-for="Tags">
                </div>

                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="Image URL" asp-for="ImgUrl">
                </div>

                <div class="mb-3">
                    <label class="form-label">Categories</label>
                    <select class="form-select" multiple name="categoryIds">
                        @foreach (var category in ViewBag.Categories)
                        {
                            var isSelected = Model.Categories.Any(c => c.Id == category.Id);
                            <option value="@category.Id" selected="@(isSelected ? "selected" : null)">
                                @category.Name
                            </option>
                        }
                    </select>
                </div>


                
                <div class="mb-3">
                    <label class="form-label">Actors</label>
                    <select class="form-select" multiple name="actorIds">
                        @foreach (var actor in ViewBag.Actors)
                        {
                            var isSelected = Model.Actors.Any(a => a.Id == actor.Id);
                            <option value="@actor.Id" selected="@(isSelected ? "selected" : null)">
                                @actor.FirstName @actor.LastName
                            </option>
                        }
                    </select>
                </div>

                
                <div class="mb-3">
                    <label class="form-label">Cinemas</label>
                    <select class="form-select" multiple name="cinemaIds">
                        @foreach (var cinema in ViewBag.Cinemas)
                        {
                            var isSelected = Model.Cinemas.Any(c => c.Id == cinema.Id);
                            <option value="@cinema.Id" selected="@(isSelected ? "selected" : null)">
                                @cinema.Name
                            </option>
                        }
                    </select>
                </div>


                <button type="submit" class="btn btn-success">Save Changes</button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        $(document).ready(function () {
            $('select[multiple]').select2({
                placeholder: "Select options",
                allowClear: true
            });
        });
    </script>
}
